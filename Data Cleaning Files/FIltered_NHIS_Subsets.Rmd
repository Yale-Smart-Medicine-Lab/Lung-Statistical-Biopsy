---
title: "NHIS Subsections"
output: html_notebook
---

```{r}

NHIS_Male <- read.csv("/Users/teresanguyen/Downloads/CleaningLungData/Data Files/male_NHISdata.csv")

NHIS_Female <- read.csv("/Users/teresanguyen/Downloads/CleaningLungData/Data Files/female_NHISdata.csv")


```

```{r}

threshold <- 0.70

# Function to find columns with enough data and always include specified columns
find_columns_with_data <- function(data, threshold, always_include) {
  non_na_counts <- colSums(!is.na(data))
  total_rows <- nrow(data)
  # Calculate the proportion of non-NA data for each column
  sufficient_data_cols <- non_na_counts / total_rows >= threshold
  # Ensure specified columns are always included
  sufficient_data_cols[always_include] <- TRUE
  # Return the names of the columns that meet the criteria or are specified to always include
  names(data)[sufficient_data_cols]
}

# Use the function to find columns for male and female datasets, always including "lung"
columns_with_data_male <- find_columns_with_data(NHIS_Male, threshold, "lung")
columns_with_data_female <- find_columns_with_data(NHIS_Female, threshold, "lung")

# Find common columns between male and female datasets
common_columns <- intersect(columns_with_data_male, columns_with_data_female)

print(columns_with_data_male)
print(columns_with_data_female)

# Save the filtered datasets to new CSV files
write.csv(filtered_male, "/Users/teresanguyen/Downloads/CleaningLungData/Data Files/male_filtered_70_NHIS.csv", row.names = FALSE)
write.csv(filtered_female, "/Users/teresanguyen/Downloads/CleaningLungData/Data Files/female_filtered_70_NHIS.csv", row.names = FALSE)


```

```{r}

# Count of NA, 1, and 0 in the "lung" column for the male dataset
male_lung_counts <- table(filtered_male$lung, useNA = "ifany")
male_lung_counts["NA"] <- sum(is.na(filtered_male$lung))  # Explicitly count NAs

# Count of NA, 1, and 0 in the "lung" column for the female dataset
female_lung_counts <- table(filtered_female$lung, useNA = "ifany")
female_lung_counts["NA"] <- sum(is.na(filtered_female$lung))  # Explicitly count NAs

# Print the counts for both datasets
print("Counts for the lung column in the male dataset:")
print(male_lung_counts)

print("Counts for the lung column in the female dataset:")
print(female_lung_counts)


```

